#!/bin/sh

if which circleci > /dev/null; then

  echo "CircleCI CLI is installed. Starting to pack orb.."
  circleci config pack ./src > build/orb.yml
  echo "Orb packed to build/orb.yml"
  circleci orb validate build/orb.yml
  ex -s -c '1i|# THIS FILE IS AUTOGENERATED AFTER GIT COMMIT. CHANGES TO THIS FILE WILL BE DISCARDED. #' -c x build/orb.yml
  git add build/orb.yml

else
  echo "ERROR: CircleCI CLI must be installed."
  exit 1
fi